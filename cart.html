<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Your Cart</title>
<style>
:root{
  --bg:#0b0c10; --panel:#11131a; --muted:#99a0ae; --text:#e8ecf1; --accent:#7dd3fc;
}
body{margin:0;background:linear-gradient(180deg,#0b0c10,#0a0b12 60%,#06070b);color:var(--text);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial}
.wrap{max-width:900px;margin:0 auto;padding:24px}
header{text-align:center;margin-bottom:20px}
h1{font-weight:800;font-size:clamp(22px,4vw,36px);margin:0}
.configCard{background:radial-gradient(1200px 500px at -10% -20%,#1b1f38 0%,#101322 28%,#0c0f1b 55%);
border:1px solid #1f2837;border-radius:16px;padding:18px;margin-bottom:18px;
box-shadow:0 10px 30px #00000055}
.configCard h3{margin:0 0 12px;font-size:18px}
.partRow{display:flex;justify-content:space-between;margin:4px 0;font-size:14px}
.partRow .label{color:var(--muted)}
.partRow .value{font-weight:600}
.partRow .price{color:var(--accent)}
.total{margin-top:28px;padding:20px;border-radius:14px;background:linear-gradient(90deg,#0e1428,#121a32);
border:1px solid #1c2540;text-align:center}
.total h2{margin:0 0 6px;font-size:22px}
.total .sum{font-weight:800;font-size:28px}
.btn{
  display:inline-flex;align-items:center;gap:10px;margin:12px 8px 0;background:linear-gradient(180deg,#1e90ff,#3aa5ff);
  color:white;border:0;border-radius:14px;padding:12px 18px;font-weight:700;cursor:pointer;box-shadow:0 10px 20px #0070ff33
}
.btn:active{transform:translateY(1px)}
.btn.clear{background:linear-gradient(180deg,#ef4444,#dc2626)}
.empty{text-align:center;color:var(--muted);padding:40px 0;font-size:15px}
.center{text-align:center;margin-top:24px}
</style>
</head>
<body>
<div class="wrap">
  <header><h1>Your Cart</h1></header>

  <div id="cartList"></div>

  <div class="total" id="totalBox">
    <h2>Total</h2>
    <div id="cartTotal" class="sum">$0</div>
    <button class="btn" id="viewBackBtn" type="button">Back to PC Builder</button>
    <button class="btn" id="viewCheckoutBtn" type="button">Checkout</button>
    <button class="btn clear" id="clearCartBtn" type="button">Clear Cart</button>
  </div>
</div>

<script>
const $ = id => document.getElementById(id);

function getCart(){
  try{
    const raw = localStorage.getItem("cart");
    if(!raw) return [];
    const parsed = JSON.parse(raw);
    return Array.isArray(parsed)?parsed:[];
  } catch(e){ localStorage.removeItem("cart"); return []; }
}

function setCart(arr){ localStorage.setItem("cart", JSON.stringify(arr||[])); }

function renderCart(){
  const cart=getCart();
  const list=$('cartList');
  let sum=0;
  list.innerHTML="";
  if(cart.length===0){
    list.innerHTML=`<div class="empty">Your cart is empty.</div>`;
  }
  cart.forEach((config,idx)=>{
    const div=document.createElement("div");
    div.className="configCard";
    div.innerHTML=`<h3>Configuration ${idx+1}</h3>`;
    let partsHTML="";
    for(const [key,val] of Object.entries(config)){
      if(key==="estTotal") continue;
      if(key==="extraFans"){
        partsHTML+=`<div class="partRow"><div class="label">Extra Fans</div><div class="value">${val}</div></div>`;
      } else {
        partsHTML+=`<div class="partRow"><div class="label">${key}</div><div class="value">${val||"â€”"}</div></div>`;
      }
    }
    div.innerHTML+=partsHTML+`<div class="partRow"><div class="label">Subtotal</div><div class="price">${config.estTotal||"$0"}</div></div>`;
    list.appendChild(div);

    const est=parseFloat((config.estTotal||"0").replace(/[^\d.]/g,""))||0;
    sum+=est;
  });
  $('cartTotal').textContent="$"+sum.toLocaleString();
}

function wire(){
  $('viewBackBtn').addEventListener('click',()=> {
    window.top.location.href="https://script.google.com/macros/s/AKfycbx5EJSbT_qEUAqy2SisKT4_E5zLBt6cYwZm5209FL5retwJXOgUnLu-vhaGSllOxhtV/exec?page=X1000.html";
  });

  $('viewCheckoutBtn').addEventListener('click',()=> {
    window.top.location.href="https://script.google.com/macros/s/AKfycbx5EJSbT_qEUAqy2SisKT4_E5zLBt6cYwZm5209FL5retwJXOgUnLu-vhaGSllOxhtV/exec?page=checkout.html";
  });

  $('clearCartBtn').addEventListener('click',()=>{
    setCart([]);
    renderCart();
  });
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
  wire();        // wires buttons
  renderCart();  // renders the cart
});
</script>
</body>
</html>
